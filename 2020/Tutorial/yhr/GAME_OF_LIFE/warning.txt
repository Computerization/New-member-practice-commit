The code cannot work.
Emm...
There's probably some problems with input or(and) output stream.
But I spend hours on it finding nothing...
I'm sorry about that.